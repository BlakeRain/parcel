{
  "previewers": [
    {
      "match": {
        "exact": "application/pdf"
      },
      "commands": [
        {
          "command": "pdftoppm",
          "args": [
            "-png",
            "-singlefile",
            "-scale-to",
            "400",
            "${input}",
            "${output}"
          ]
        },
        {
          "command": "mv",
          "args": [
            "${output}.png",
            "${output}"
          ]
        }
      ]
    },
    {
      "match": {
        "prefix": "image/"
      },
      "commands": [
        {
          "command": "convert",
          "args": [
            "${input}",
            "-resize",
            "400x400^",
            "-gravity",
            "center",
            "-extent",
            "400x400",
            "${output}"
          ]
        }
      ]
    },
    {
      "match": {
        "prefix": "video/"
      },
      "commands": [
        {
          "command": "ffmpeg" ,
          "args": [
            "-i",
            "${input}",
            "-vf",
            "thumbnail,scale=400:-1",
            "-frames:v",
            "1",
            "${temp_dir}/${input_base}.png"
          ]
        },
        {
          "command": "mv",
          "args": [
            "${temp_dir}/${input_base}.png",
            "${output}"
          ]
        }
      ]
    },
    {
      "feature": "libreoffice",
      "match": {
        "exact": "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
      },
      "commands": [
        {
          "command": {
            "linux": "libreoffice",
            "macos": "soffice"
          },
          "args": [
            "--headless",
            "--convert-to",
            "pdf",
            "--outdir",
            "${temp_dir}",
            "${input}"
          ]
        },
        {
          "command": "pdftoppm",
          "args": [
            "-png",
            "-singlefile",
            "-scale-to",
            "400",
            "${temp_dir}/${input_base}.pdf",
            "${output}"
          ]
        },
        {
          "command": "rm",
          "args": [
            "${temp_dir}/${input_base}.pdf"
          ]
        },
        {
          "command": "mv",
          "args": [
            "${output}.png",
            "${output}"
          ]
        }
      ]
    },
    {
      "feature": "libreoffice",
      "match": {
        "exact": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
      },
      "commands": [
        {
          "command": {
            "linux": "libreoffice",
            "macos": "soffice"
          },
          "args": [
            "--headless",
            "--convert-to",
            "pdf",
            "--outdir",
            "${temp_dir}",
            "${input}"
          ]
        },
        {
          "command": "pdftoppm",
          "args": [
            "-png",
            "-singlefile",
            "-scale-to",
            "400",
            "${temp_dir}/${input_base}.pdf",
            "${output}"
          ]
        },
        {
          "command": "rm",
          "args": [
            "${temp_dir}/${input_base}.pdf"
          ]
        },
        {
          "command": "mv",
          "args": [
            "${output}.png",
            "${output}"
          ]
        }
      ]
    }
  ]
}
